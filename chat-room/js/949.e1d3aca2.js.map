{"version":3,"file":"js/949.e1d3aca2.js","mappings":"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","sources":["webpack://chatroom/./src/views/AIChat.vue?a43b","webpack://chatroom/src/views/AIChat.vue","webpack://chatroom/./src/views/AIChat.vue?e4d2","webpack://chatroom/./src/views/AIChat.vue"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"ai-chat-container\"},[_vm._m(0),_c('div',{staticClass:\"messages\"},[_vm._l((_vm.messages),function(message,index){return _c('div',{key:index,staticClass:\"message\",class:{ 'ai-message': message.role === 'assistant', 'user-message': message.role === 'user' }},[_c('el-avatar',{staticClass:\"message-avatar\",attrs:{\"src\":message.role === 'user'\n      ? _vm.avatar\n      : _vm.img}}),_c('div',{staticClass:\"message-bubble\"},[_c('div',{staticClass:\"message-content\",domProps:{\"innerHTML\":_vm._s(_vm.formatMessage(message.content))}})])],1)}),(_vm.isLoading)?_c('div',{staticClass:\"message ai-message loading-indicator\"},[_c('el-avatar',{staticClass:\"message-avatar\",attrs:{\"src\":_vm.img}}),_c('div',{staticClass:\"message-bubble loading-bubble\"},[_c('van-loading',{attrs:{\"color\":\"#1989fa\"}})],1)],1):_vm._e()],2),_c('div',{staticClass:\"input-area\"},[_c('el-input',{staticClass:\"input-box\",attrs:{\"placeholder\":\"输入您的问题...\"},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.sendMessage.apply(null, arguments)}},model:{value:(_vm.inputMessage),callback:function ($$v) {_vm.inputMessage=$$v},expression:\"inputMessage\"}},[_c('el-button',{attrs:{\"slot\":\"append\",\"icon\":\"el-icon-position\",\"loading\":_vm.isLoading},on:{\"click\":_vm.sendMessage},slot:\"append\"},[_vm._v(\"发送\")])],1)],1)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"header\"},[_c('h2',[_vm._v(\"AI 智能助手\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"ai-chat-container\">\r\n\r\n    <div class=\"header\">\r\n      <h2>AI 智能助手</h2>\r\n    </div>\r\n\r\n    <div class=\"messages\">\r\n      <!-- <video class='video-back' src=\"../assets/img/ai.mp4\" autoplay loop muted></video> -->\r\n      <div v-for=\"(message, index) in messages\" :key=\"index\" class=\"message\"\r\n        :class=\"{ 'ai-message': message.role === 'assistant', 'user-message': message.role === 'user' }\">\r\n        <el-avatar :src=\"message.role === 'user'\r\n        ? avatar\r\n        : img\r\n        \" class=\"message-avatar\" />\r\n        <div class=\"message-bubble\">\r\n          <div class=\"message-content\" v-html=\"formatMessage(message.content)\"></div>\r\n          <!-- <div class=\"message-time\">{{ message.timestamp | formatTime }}</div> -->\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 加载状态 -->\r\n      <div v-if=\"isLoading\" class=\"message ai-message loading-indicator\">\r\n        <el-avatar :src=\"img\" class=\"message-avatar\" />\r\n        <div class=\"message-bubble loading-bubble\">\r\n          <van-loading color=\"#1989fa\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"input-area\">\r\n      <el-input v-model=\"inputMessage\" placeholder=\"输入您的问题...\" @keyup.enter.native=\"sendMessage\" class=\"input-box\">\r\n        <el-button slot=\"append\" icon=\"el-icon-position\" @click=\"sendMessage\" :loading=\"isLoading\">发送</el-button>\r\n      </el-input>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport img from '../assets/img/AI头像.png';\r\nimport avatar from '../assets/img/羊.png';\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      avatar,\r\n      img,\r\n      messages: [],\r\n      inputMessage: '',\r\n      isLoading: false\r\n    };\r\n  },\r\n  methods: {\r\n    formatMessage (content) {\r\n      return content.replace(/```(\\w*)\\n([\\s\\S]*?)```/g, (match, lang, code) => {\r\n        return `<div class=\"code-block\">\r\n          ${lang ? `<div class=\"code-language\">${lang}</div>` : ''}\r\n          <pre><code>${code.trim()}</code></pre>\r\n        </div>`\r\n      })\r\n    },\r\n    async sendMessage () {\r\n      if (!this.inputMessage.trim()) return;\r\n\r\n      const userMessage = {\r\n        role: 'user',\r\n        content: this.inputMessage,\r\n        timestamp: new Date().getTime()\r\n      };\r\n\r\n      this.messages.push(userMessage);\r\n      this.inputMessage = '';\r\n\r\n      try {\r\n        this.isLoading = true;\r\n        const aiResponse = await this.$chatCompletion([\r\n          ...this.messages,\r\n          userMessage\r\n        ]);\r\n        const tempMessage = {\r\n          role: 'assistant',\r\n          fullContent: aiResponse,\r\n          content: '',\r\n          timestamp: new Date().getTime(),\r\n          isTyping: true\r\n        };\r\n        this.messages.push(tempMessage);\r\n\r\n        let index = 0;\r\n        const typingInterval = setInterval(() => {\r\n          if (index < aiResponse.length) {\r\n            tempMessage.content += aiResponse.charAt(index);\r\n            this.messages.splice(this.messages.length - 1, 1, { ...tempMessage });\r\n            index++;\r\n          } else {\r\n            clearInterval(typingInterval);\r\n            tempMessage.isTyping = false;\r\n            this.messages.splice(this.messages.length - 1, 1, { ...tempMessage });\r\n          }\r\n        }, 30);\r\n        this.isLoading = false;\r\n      } catch (error) {\r\n        console.error('发送消息失败:', error);\r\n        this.$message.error(\r\n          error.message.includes('余额不足')\r\n            ? 'AI服务不可用：请检查API密钥或账户余额'\r\n            : '消息发送失败，请稍后重试'\r\n        );\r\n        this.isLoading = false;\r\n      }\r\n    }\r\n  },\r\n  filters: {\r\n    formatTime (timestamp) {\r\n      return new Date(timestamp).toLocaleTimeString();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.ai-chat-container {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.video-back {\r\n  width: 100%;\r\n  object-fit: cover;\r\n  z-index: -1;\r\n}\r\n\r\n.messages {\r\n  z-index: 2;\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: 20px;\r\n}\r\n\r\n.ai-chat-container .header {\r\n  background: linear-gradient(to right, var(--header-gradient, #409EFF), #66b1ff);\r\n  padding: 16px 24px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n}\r\n\r\n.header h2 {\r\n  color: white;\r\n  margin: 0;\r\n  font-size: 1.5em;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.header h2::before {\r\n  content: '';\r\n  display: block;\r\n  width: 32px;\r\n  height: 32px;\r\n  /* background: url('/ai-avatar.png') center/contain no-repeat; */\r\n  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .header {\r\n    padding: 12px 16px;\r\n  }\r\n\r\n  .header h2 {\r\n    font-size: 1.2em;\r\n    gap: 8px;\r\n  }\r\n\r\n  .header h2::before {\r\n    width: 24px;\r\n    height: 24px;\r\n  }\r\n}\r\n\r\n.message {\r\n  display: flex;\r\n  margin: 15px 0;\r\n}\r\n\r\n.message-avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  margin: 0 15px;\r\n}\r\n\r\n.message-bubble {\r\n  max-width: 70%;\r\n  padding: 12px 16px;\r\n  border-radius: 12px;\r\n  position: relative;\r\n}\r\n\r\n.user-message {\r\n  flex-direction: row-reverse;\r\n}\r\n\r\n.user-message .message-bubble {\r\n  background-color: #409EFF;\r\n  color: white;\r\n}\r\n\r\n.code-block {\r\n  background-color: #282c34;\r\n  border-radius: 8px;\r\n  padding: 16px;\r\n  margin: 12px 0;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  position: relative;\r\n}\r\n\r\n.code-language {\r\n  position: absolute;\r\n  top: -12px;\r\n  right: 16px;\r\n  background: #61afef;\r\n  color: white;\r\n  padding: 4px 8px;\r\n  border-radius: 4px;\r\n  font-size: 0.8em;\r\n  font-family: 'Fira Code', monospace;\r\n}\r\n\r\n.code-block pre {\r\n  margin: 0;\r\n  overflow-x: auto;\r\n}\r\n\r\n.code-block code {\r\n  font-family: 'Fira Code', monospace;\r\n  font-size: 0.9em;\r\n  line-height: 1.5;\r\n  color: #abb2bf;\r\n  white-space: pre-wrap;\r\n}\r\n\r\n@keyframes typing {\r\n  from {\r\n    width: 0\r\n  }\r\n\r\n  to {\r\n    width: 100%\r\n  }\r\n}\r\n\r\n@keyframes blink-caret {\r\n\r\n  from,\r\n  to {\r\n    border-color: transparent\r\n  }\r\n\r\n  50% {\r\n    border-color: #409EFF\r\n  }\r\n}\r\n\r\n.typing {\r\n  position: relative;\r\n  overflow: hidden;\r\n  border-right: 2px solid #409EFF;\r\n  animation:\r\n    typing 3.5s steps(40, end) forwards,\r\n    blink-caret .75s step-end infinite;\r\n}\r\n\r\n.message-content {\r\n  min-height: 1.2em;\r\n}\r\n\r\n/* 加载动画 */\r\n.loading-bubble {\r\n  position: relative;\r\n  background: linear-gradient(145deg, #f5f7fa 30%, #e6f7ff 70%);\r\n  min-height: 60px;\r\n  box-shadow: 0 8px 32px rgba(64, 158, 255, 0.15);\r\n  overflow: hidden;\r\n  animation: breathing 2.5s ease-in-out infinite;\r\n}\r\n\r\n\r\n\r\n@keyframes particle-flow {\r\n  0% {\r\n    transform: rotate(0deg) translate(0);\r\n  }\r\n\r\n  100% {\r\n    transform: rotate(360deg) translate(50px);\r\n  }\r\n}\r\n\r\n@keyframes breathing {\r\n\r\n  0%,\r\n  100% {\r\n    transform: scale(1);\r\n    opacity: 0.95;\r\n  }\r\n\r\n  50% {\r\n    transform: scale(1.02);\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n.dot-wave {\r\n  display: flex;\r\n  gap: 8px;\r\n  padding: 12px;\r\n}\r\n\r\n.dot {\r\n  width: 12px;\r\n  height: 12px;\r\n  animation:\r\n    dot-wave 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite,\r\n    dot-glow 1.5s ease-in-out infinite;\r\n  background:\r\n    radial-gradient(circle at 30% 30%,\r\n      #fff 10%,\r\n      var(--dot-color, #409EFF) 80%);\r\n  box-shadow: 0 2px 6px rgba(64, 158, 255, 0.3);\r\n}\r\n\r\n@keyframes dot-glow {\r\n\r\n  0%,\r\n  100% {\r\n    opacity: 0.9;\r\n  }\r\n\r\n  50% {\r\n    opacity: 1;\r\n    box-shadow: 0 2px 10px rgba(64, 158, 255, 0.5);\r\n  }\r\n}\r\n\r\n@keyframes dot-wave {\r\n\r\n  0%,\r\n  80%,\r\n  100% {\r\n    transform: translateY(0) scale(1);\r\n    opacity: 0.8;\r\n  }\r\n\r\n  40% {\r\n    transform: translateY(-15px) scale(1.2);\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n.wave-loader {\r\n  background: linear-gradient(90deg,\r\n      rgba(64, 158, 255, 0.8) 0%,\r\n      rgba(102, 177, 255, 0.9) 50%,\r\n      rgba(64, 158, 255, 0.8) 100%);\r\n  animation:\r\n    wave-loader 1.2s cubic-bezier(0.4, 0, 0.2, 1) infinite,\r\n    glow-pulse 2s ease-in-out infinite;\r\n  height: 4px;\r\n  border-radius: 2px;\r\n  box-shadow: 0 2px 8px rgba(64, 158, 255, 0.3);\r\n}\r\n\r\n@keyframes glow-pulse {\r\n\r\n  0%,\r\n  100% {\r\n    filter: drop-shadow(0 0 5px rgba(64, 158, 255, 0.3));\r\n  }\r\n\r\n  50% {\r\n    filter: drop-shadow(0 0 10px rgba(64, 158, 255, 0.6));\r\n  }\r\n}\r\n\r\n\r\n@keyframes wave-loader {\r\n  0% {\r\n    background-position: 200% 0;\r\n  }\r\n\r\n  100% {\r\n    background-position: -200% 0;\r\n  }\r\n}\r\n\r\n/* 骨架屏效果 */\r\n.skeleton-loader {\r\n  background: #f5f7fa;\r\n  padding: 16px;\r\n  border-radius: 12px;\r\n}\r\n\r\n.skeleton-line {\r\n  height: 14px;\r\n  background: linear-gradient(90deg,\r\n      #ececec 25%,\r\n      #f5f5f5 50%,\r\n      #ececec 75%);\r\n  background-size: 200% 100%;\r\n  animation: skeleton-loading 1.5s ease-in-out infinite;\r\n  border-radius: 4px;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n@keyframes skeleton-loading {\r\n  0% {\r\n    background-position: 200% 0;\r\n  }\r\n\r\n  100% {\r\n    background-position: -200% 0;\r\n  }\r\n}\r\n\r\n.ai-message .message-bubble {\r\n  background-color: #f5f7fa;\r\n  border: 1px solid #ebeef5;\r\n}\r\n\r\n.input-area {\r\n  padding: 20px;\r\n  border-top: 1px solid #ebeef5;\r\n}\r\n\r\n.input-box {\r\n  border-radius: 20px;\r\n}\r\n</style>","import mod from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AIChat.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AIChat.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./AIChat.vue?vue&type=template&id=071dfbc9&scoped=true\"\nimport script from \"./AIChat.vue?vue&type=script&lang=js\"\nexport * from \"./AIChat.vue?vue&type=script&lang=js\"\nimport style0 from \"./AIChat.vue?vue&type=style&index=0&id=071dfbc9&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"071dfbc9\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","_m","_l","message","index","key","class","role","attrs","avatar","img","domProps","_s","formatMessage","content","_e","nativeOn","$event","type","indexOf","_k","keyCode","sendMessage","apply","arguments","model","value","callback","$$v","inputMessage","expression","isLoading","on","slot","_v","staticRenderFns","data","messages","methods","replace","match","lang","code","trim","userMessage","timestamp","Date","getTime","push","aiResponse","$chatCompletion","tempMessage","fullContent","isTyping","typingInterval","setInterval","length","charAt","splice","clearInterval","error","$message","includes","filters","formatTime","toLocaleTimeString","component"],"sourceRoot":""}